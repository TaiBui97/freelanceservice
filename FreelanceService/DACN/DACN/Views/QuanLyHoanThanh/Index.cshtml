
@model DACN.Models.BusinessModel.DanhSachDHHT
@{
    /**/

    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout _Admin.cshtml";
}
<div class="content mt-3">
    <div class="animated fadeIn">
        <div class="row">

            <div class="col-md-12">
                <div class="card">

                    <div class="card-body">
                        <table id="bootstrap-data-table-export" class="table table-striped table-bordered">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Mã Đơn Hàng</th>
                                    <th>Tên Người Bán</th>
                                    <th>Trạng Thái</th>
                                    <th>Giá Đơn Hàng</th>
                                    <th>Mã Sản Phẩm</th>
                                    <th>Số Lần Gửi Minh Chứng</th>
                                    <th>Thời Hạn</th>
                                    <th style="text-align:center" colspan="3">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.donDatHangs)
                                {

                                    if (item != null && item.Delete==false)
                                    {
                                        var dem = Model.donHangHoanThanhs.Where(a => a.MaDDH == item.MaDDH).Count();
                                        var temp = Model.listSanPham.FirstOrDefault(a => a.MaSP == item.MaSP);
                                        var tk = Model.listTaiKhoan.FirstOrDefault(a => a.MaTaiKhoan == temp.MaTaiKhoan);
                                        var time = DateTime.Parse(item.NgayGiao.ToString());
                                        <tr>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.MaDDH)
                                            </td>
                                            <td>

                                                @Html.DisplayFor(modelItem => tk.TenTaiKhoan)
                                            </td>
                                            @if (item.TrangThai == true)
                                            {
                                                <td>Đã hoàn thành</td>
                                            }
                                            else
                                            {
                                                <td>Chưa hoàn thành</td>
                                            }
                                            <td>
                                                @Html.DisplayFor(modelItem => item.GiaDDH)
                                            </td>
                                            <td>
                                                @item.MaSP
                                            </td>
                                            <td>@dem</td>
                                            @if (time.Subtract(DateTime.Now).Days > 0)
                                            {
                                                <td>Còn @time.Subtract(DateTime.Now).Days ngày</td>
                                            }
                                            else
                                            {
                                                <td>Đã hết hạn</td>
                                            }
                                            <td style="text-align:center">
                                                <button class="btn btn-success btn-custom" type="submit"><a style="color:white" href="@Url.Action("HoanThanh", "QuanLyHoanThanh", new {  @maddh = item.MaDDH }) ">Hoàn Thành Đơn Hàng</a></button>
                                            </td>
                                        </tr>
                                    }

                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>



        </div><!-- .animated -->
    </div>

</div>

